/* App.css - Mobile Fix 100dvh */

:root {
  --primary-color: #fe2c55;
}

html, body {
  margin: 0; padding: 0; 
  background-color: black; color: white;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  overflow: hidden; 
  width: 100%; 
  /* FIX: Usar 100dvh asegura que ocupamos el espacio VISIBLE real */
  height: 100dvh; 
  position: fixed; /* Evita scroll elástico en iOS */
}

#root {
  display: flex; justify-content: center; width: 100%; 
  height: 100dvh; 
  background-color: #000; margin: 0;
}

.app-container {
  height: 100dvh; /* Altura dinámica */
  width: 100%; max-width: 480px;
  background: #000; position: relative;
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
  overflow: hidden; display: flex; flex-direction: column;
}

.app-container.comments-open .video-scroll-container {
  transform: scale(0.92) translateY(-20px);
  border-radius: 15px; opacity: 0.6; pointer-events: none;
}

.video-scroll-container {
  flex: 1; width: 100%; overflow-y: scroll;
  scroll-snap-type: y mandatory; scroll-behavior: smooth;
  scroll-snap-stop: always; scrollbar-width: none; -ms-overflow-style: none;
  overscroll-behavior-y: none;
}
.video-scroll-container::-webkit-scrollbar { display: none; }

.video-card, .end-screen-card {
  height: 100%; width: 100%; 
  scroll-snap-align: start; scroll-snap-stop: always; 
  position: relative; background-color: #000; overflow: hidden;
}

.video-player { width: 100%; height: 100%; object-fit: cover; display: block; }

/* UI SUPERIOR */
.top-bar {
  position: absolute; top: 0; left: 0; width: 100%; 
  padding: 15px 20px; padding-top: max(15px, env(safe-area-inset-top));
  box-sizing: border-box; display: flex; justify-content: space-between; align-items: center;
  z-index: 10; background: linear-gradient(to bottom, rgba(0,0,0,0.4), transparent); pointer-events: none;
}
.app-title { font-weight: 700; font-size: 16px; text-shadow: 0 1px 3px rgba(0,0,0,0.5); }
.view-count-badge {
  display: flex; align-items: center; background: rgba(0, 0, 0, 0.4);
  padding: 4px 8px; border-radius: 20px; font-size: 11px; font-weight: 600; backdrop-filter: blur(5px);
}

/* SIDEBAR - Subida para evitar cortes */
.right-sidebar {
  position: absolute; right: 10px; 
  /* Subimos más la barra (130px) para librar cualquier barra de navegación */
  bottom: calc(130px + env(safe-area-inset-bottom));
  display: flex; flex-direction: column; align-items: center; gap: 15px; z-index: 15;
}
.sidebar-item { display: flex; flex-direction: column; align-items: center; text-align: center; }
.profile-pic-container {
  width: 38px; height: 38px; border-radius: 50%; border: 2px solid var(--primary-color);
  overflow: hidden; margin-bottom: 8px; background-color: #333;
}
.profile-img { width: 100%; height: 100%; object-fit: cover; pointer-events: none; }
.sidebar-btn {
  background: none; border: none; color: white; font-size: 26px; padding: 0; cursor: pointer;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.4)); transition: transform 0.1s;
  pointer-events: auto; /* CRÍTICO: Asegura que el botón reciba el toque */
}
.sidebar-btn:active { transform: scale(0.9); }
.sidebar-label { font-size: 11px; font-weight: 600; margin-top: 2px; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }

/* INFO INFERIOR */
.bottom-info {
  position: absolute; bottom: 0; left: 0; width: 100%;
  padding: 15px; padding-right: 70px; 
  /* Padding inferior generoso para levantar el texto */
  padding-bottom: calc(40px + env(safe-area-inset-bottom));
  box-sizing: border-box; z-index: 20; text-align: left;
  background: linear-gradient(to top, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.8) 30%, rgba(0,0,0,0.4) 70%, transparent 100%);
  display: flex; flex-direction: column; justify-content: flex-end;
  max-height: 60%; pointer-events: none;
}
.username-row { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; pointer-events: auto; }
.username { font-weight: 700; font-size: 15px; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }

.description-container { pointer-events: auto; width: 100%; }
.description-text {
  font-size: 13px; line-height: 1.4; opacity: 0.95; white-space: pre-line;
  display: block; overflow: hidden; max-height: 2.8em;
  transition: max-height 0.4s cubic-bezier(0.25, 1, 0.5, 1);
  -webkit-user-select: none; user-select: none;
}
.description-text.expanded { max-height: 35vh; overflow-y: auto; margin-top: 5px; }
.toggle-more-btn {
  background: none; border: none; color: #ccc; font-weight: 600; font-size: 12px;
  cursor: pointer; padding: 0; margin-top: 4px; pointer-events: auto;
}

/* OVERLAY ICONOS */
.mute-overlay {
  position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
  background: transparent; padding: 0; pointer-events: none; opacity: 0; transition: opacity 0.3s; 
  z-index: 20; filter: drop-shadow(0 0 10px rgba(0,0,0,0.5));
}
.mute-overlay.show { opacity: 1; }
.mute-icon-svg { color: white; font-size: 50px; stroke-width: 1.5; }

/* TELÓN */
.expanded-backdrop {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  background: transparent; z-index: 18; cursor: default;
}

/* PANTALLA INICIO */
.start-screen-overlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background-color: #000; z-index: 500;
  display: flex; flex-direction: column; justify-content: center; align-items: center; color: white;
}
.big-profile-container {
  width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--primary-color);
  margin-bottom: 20px; overflow: hidden; flex-shrink: 0;
  display: flex; justify-content: center; align-items: center;
}
.big-profile-container img { width: 100%; height: 100%; object-fit: cover; }
.start-title { font-size: 20px; font-weight: 700; margin-bottom: 30px; }
.enter-system-btn {
  background: var(--primary-color); color: white; border: none; padding: 12px 35px;
  font-size: 16px; font-weight: 700; border-radius: 30px; cursor: pointer;
  text-transform: uppercase; letter-spacing: 1px;
}

/* MODALES */
.overlay-popup {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.8); z-index: 2000;
  display: flex; align-items: center; justify-content: center; backdrop-filter: blur(5px);
}
.popup-box {
  background: #1a1a1a; padding: 20px; border-radius: 12px;
  text-align: center; border: 1px solid #333; max-width: 80%; width: 300px;
}
.popup-actions { display: flex; gap: 10px; justify-content: center; margin-top: 15px; }
.popup-btn { padding: 10px 20px; border-radius: 5px; border: none; font-weight: bold; cursor: pointer; }
.btn-confirm { background: var(--primary-color); color: white; }
.btn-cancel { background: #333; color: white; }

/* SHEET COMENTARIOS */
.comments-sheet-container {
  position: absolute; bottom: 0; left: 0; width: 100%; height: 70%;
  background-color: #121212; z-index: 300;
  border-top-left-radius: 15px; border-top-right-radius: 15px;
  transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.21, 0.6, 0.35, 1);
  display: flex; flex-direction: column; max-height: 80dvh;
}
.comments-sheet-container.open { transform: translateY(0); }
.sheet-backdrop { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 299; }
.sheet-handle { width: 40px; height: 4px; background-color: #444; border-radius: 2px; margin: 10px auto; flex-shrink: 0; }
.comments-header { display: flex; align-items: center; justify-content: center; padding: 10px; border-bottom: 1px solid #333; font-weight: 600; font-size: 14px; flex-shrink: 0; }
.comments-list { 
  flex: 1; overflow-y: auto; padding: 15px; 
  padding-bottom: calc(20px + env(safe-area-inset-bottom));
}
.comment-item { display: flex; gap: 12px; margin-bottom: 15px; font-size: 13px; }
.comment-avatar { width: 32px; height: 32px; border-radius: 50%; background-color: #333; overflow: hidden; display: flex; justify-content: center; align-items: center; flex-shrink: 0; }
.comment-content { flex: 1; text-align: left; }
.comment-user-id { font-weight: 600; font-size: 12px; color: #ddd; }
.comment-text { color: #fff; line-height: 1.3; }
.comment-input-area { 
  padding: 10px 15px; border-top: 1px solid #333; display: flex; align-items: center; gap: 10px; background-color: #121212; 
  flex-shrink: 0; padding-bottom: max(10px, env(safe-area-inset-bottom));
}
.comment-input-area input { flex: 1; background: #262626; border: none; padding: 10px 15px; border-radius: 20px; color: white; outline: none; }
.comment-input-area button { background: none; border: none; color: var(--primary-color); font-weight: 600; cursor: pointer; }

/* BARRA PROGRESO */
.progress-container { 
  position: absolute; bottom: 0; left: 0; width: 100%; height: 4px; 
  background: rgba(255,255,255,0.2); cursor: pointer; z-index: 100; transition: height 0.1s; 
  /* Ajuste para que se vea sobre la barra del iPhone */
  margin-bottom: env(safe-area-inset-bottom);
}
.progress-container:hover { height: 8px; }
.progress-bar { height: 100%; background: #fff; width: 0%; box-shadow: 0 0 5px rgba(0,0,0,0.5); }

/* PANTALLA FINAL */
.end-screen-content { display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; color: white; text-align: center; gap: 15px; }
.end-message { font-size: 24px; font-weight: 800; text-transform: uppercase; }
.sicko-text { color: var(--primary-color); font-family: inherit; font-weight: 800; font-size: 28px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 25px; }
.end-btn { width: 80%; padding: 12px 20px; border-radius: 30px; font-size: 14px; font-weight: 800; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; text-transform: uppercase; }
.btn-void { background: var(--primary-color); color: white; border: none; }
.btn-share { background: transparent; color: white; border: 2px solid white; }
.btn-restart { background: transparent; color: #aaa; border: none; font-size: 12px; text-decoration: underline; text-transform: none; }